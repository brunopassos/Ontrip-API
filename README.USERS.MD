# Users

The User object is defined as:

| **Field**   | **Type** | **Description**                                   |
| ----------- | -------- | ------------------------------------------------- |
| id          | string   | User's unique identifier                          |
| username    | string   | User name                                         |
| email       | string   | User email                                        |
| password    | string   | User password                                     |
| dateOfBirth | string   | User's date of birth                              |
| isAdm       | boolean  | Defines whether a user is an administrator or not |
| isActive    | boolean  | Defines whether a user is active or not           |
| files       | file     | User's profile photo file sent in the request     |
| photo       | string   | User's profile photo url generated by cloudinary  |

<br>

### **Endpoints**

| **Method** | **Route**      | **Description**                                 |
| ---------- | -------------- | ----------------------------------------------- |
| POST       | /users         | Creates a user                                  |
| GET        | /users         | List all users                                  |
| GET        | /users/:userId | Lists a user using its ID as a parameter        |
| PATCH      | /users/:userId | Updates a user using its ID as a parameter      |
| DELETE     | /users/:userId | Soft-deletes a user using its ID as a parameter |

<br>

## POST /users

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: None
- Content-type: multipart/form-data

<br>

**Request body example**

```multipart/form-data
  username: "Bob Spencer",
  email: "bobspencer@email.com",
  password: "874aS4A6F65i",
  dateOfBirth: "14/03/1993",
  isAdm: false,
  files?: file.jpg
```

<br>

#### Expected Response:

<br>

**Status 201 - Created**

```json
{
  "message": "User created with success",
  "user": {
    "id": "f1719800-2e5a-4270-88de-64380f73dd3d",
    "username": "Bob Spencer",
    "email": "bobspencer@email.com",
    "dateOfBirth": "14/03/1993",
    "photo": "https://res.cloudinary.com/de8wdumps/image/upload/v1662750917/zdlf9ppnkqfjlbxejo8f.jpg",
    "isAdm": false,
    "isActive": true
  }
}
```

<br>

#### Error Responses:

<br>

**Status 400 - Missing required field**

```json
{
  "status": "Error",
  "code": 400,
  "message": "(any object key) is a required field"
}
```

<br>

**Status 400 - Invalid data type**

```json
{
  "status": "Error",
  "code": 400,
  "message": "(any object key) has an invalid type"
}
```

<br>

**Status 413 - Data length too large**

```json
{
  "status": "Error",
  "code": 413,
  "message": "(object key) length too large"
}
```

<br>

**Status 409 - Email already exists**

```json
{
  "status": "Error",
  "code": 409,
  "message": "This email already exists"
}
```

#

## GET /users

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Bearer Token
- User must be an admin
- Content-type: application/json
- Empty Body

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Successful request",
  "users": [
    {
      "id": "f1719800-2e5a-4270-88de-64380f73dd3d",
      "username": "Bob Spencer",
      "email": "bobspencer@email.com",
      "dateOfBirth": "14/03/1993",
      "photo": "https://res.cloudinary.com/de8wdumps/image/upload/v1662750917/zdlf9ppnkqfjlbxejo8f.jpg",
      "isAdm": false,
      "isActive": true
    },
    ...
  ]
}
```

<br>

#### Error Responses:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User is not an admin"
}
```

<br>

#

## GET /users/:userId

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Bearer Token
- User must be an admin or the owner of the account
- Content-type: application/json
- Empty Body

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "Successful request",
  "user": {
    "id": "f1719800-2e5a-4270-88de-64380f73dd3d",
    "username": "Bob Spencer",
    "email": "bobspencer@email.com",
    "dateOfBirth": "14/03/1993",
    "photo": "https://res.cloudinary.com/de8wdumps/image/upload/v1662750917/zdlf9ppnkqfjlbxejo8f.jpg",
    "isAdm": false,
    "isActive": true
  }
}
```

<br>

#### Error Responses:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin or the owner of the account**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User must be an admin or the owner of the account"
}
```

<br>

**Status 404 - User not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "User not found"
}
```

#

## PATCH /users/:userId

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Bearer Token
- User must be an admin or the owner of the account
- Content-type: multipart/form-data

<br>

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

**Request body example**

```multipart/form-data
  username?: "Bob Spencer",
  email?: "bob_spencer@email.com",
  password?: "874aS4A6F65i",
  dateOfBirth?: "14/03/1993",
  *isAdm?: false,
  file?: file.jpg
```

- At least one field is required
- Only Adm users can update the isAdm field

<br>

#### Expected Responses:

<br>

**Status 200 - OK**

```json
{
  "message": "User updated with success",
  "user": {
    "id": "f1719800-2e5a-4270-88de-64380f73dd3d",
    "username": "Bob Spencer",
    "email?": "bob_spencer@email.com",
    "dateOfBirth": "14/03/1993",
    "photo": "https://res.cloudinary.com/de8wdumps/image/upload/v1662750917/zdlf9ppnkqfjlbxejo8f.jpg9",
    "isAdm": false,
    "isActive": true
  }
}
```

<br>

#### Expected Errors:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin or the owner of the account**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User must be an admin or the owner of the account"
}
```

<br>

**Status 409 - Email already exists**

```json
{
  "status": "Error",
  "code": 409,
  "message": "Email already exists"
}
```

<br>

**Status 400 - Invalid data type**

```json
{
  "status": "Error",
  "code": 400,
  "message": "(any object key) has an invalid type"
}
```

<br>

**Status 413 - Data length too large**

```json
{
  "status": "Error",
  "code": 413,
  "message": "(object key) length too large"
}
```

<br>

**Status 404 - User not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "User not found"
}
```

<br>

#

## DELETE /users/:userId

<br>

#### Request:

- Host: https://ontrip.herokuapp.com/
- Authorization: Bearer Token
- User must be an admin or the owner of the account
- Content-type: application/json
- Empty Body

**Request headers**

```json
{
  "authorization": "Bearer Token"
}
```

<br>

#### Expected Response:

<br>

**Status 200 - OK**

```json
{
  "message": "User deleted with success"
}
```

<br>

#### Expected Errors:

<br>

**Status 401 - Missing authorization token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Missing authorization token"
}
```

<br>

**Status 401 - Invalid token**

```json
{
  "status": "Error",
  "code": 401,
  "message": "Invalid token"
}
```

<br>

**Status 401 - User is not an admin or the owner of the account**

```json
{
  "status": "Error",
  "code": 401,
  "message": "User must be an admin or the owner of the account"
}
```

<br>

**Status 404 - User not found**

```json
{
  "status": "Error",
  "code": 404,
  "message": "User not found"
}
```

<br>

**Status 400 - User already deleted**

```json
{
  "status": "Error",
  "code": 400,
  "message": "User already deleted"
}
```

<br>

#
